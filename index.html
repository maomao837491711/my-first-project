<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://maomao837491711.github.io/jianban/jianbanlogo.png">
    <link rel="apple-touch-icon" href="https://maomao837491711.github.io/jianban/jianbanlogo.png">
    <title>åŠ å¯†è´§å¸å‘¨æœŸç›‘æ§</title>
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: #161b22;
            --text-main: #c9d1d9;
            --text-highlight: #58a6ff;
            --btc-color: #f7931a;
            --ltc-color: #345d9d;
            --bull-color: #238636;
            --bear-color: #da3633;
            --gold-color: #d29922;
            --border: #30363d;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 15px;
            text-transform: uppercase;
        }
        .container {
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        /* ğŸ”® é¢„æµ‹çœ‹æ¿æ ·å¼ */
        .prediction-card {
            border: 1px solid var(--gold-color);
            background: linear-gradient(180deg, rgba(210, 153, 34, 0.05) 0%, rgba(22, 27, 34, 1) 100%);
        }
        .pred-header {
            color: var(--gold-color);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .pred-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            align-items: center;
        }
        .pred-row:last-child { border-bottom: none; }
        .pred-label { color: #8b949e; font-size: 0.9rem; }
        .pred-value { font-family: monospace; font-weight: bold; font-size: 1rem; }
        
        .bull-val { color: #3fb950; }
        .bear-val { color: #f85149; }
        .gold-val { color: var(--gold-color); font-size: 1.1rem; }
        
        .dynamic-row {
            background: rgba(255,255,255,0.03);
            margin: 0 -20px;
            padding: 10px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .price-diff { color: #ff7b72; font-weight: bold; } 

        .card.btc::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background-color: var(--btc-color); }
        .card.ltc::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background-color: var(--ltc-color); }

        .coin-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        .coin-name { font-size: 1.2rem; font-weight: bold; color: #ffffff; }
        .coin-symbol { font-size: 0.9rem; opacity: 0.7; background: #21262d; padding: 2px 6px; border-radius: 4px; }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9rem; }
        .label { color: #8b949e; }
        .value { font-family: monospace; color: #e6edf3; }
        .countdown-box { background: #0d1117; margin-top: 15px; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #30363d; }
        .timer { font-size: 1.6rem; font-weight: bold; font-family: monospace; color: var(--text-highlight); margin: 5px 0; }
        .date-est { font-size: 0.8rem; color: #8b949e; }
        .progress-container { margin-top: 15px; background-color: #21262d; border-radius: 10px; height: 8px; overflow: hidden; }
        .progress-bar { height: 100%; border-radius: 10px; transition: width 1s ease; }
        .btc .progress-bar { background-color: var(--btc-color); }
        .ltc .progress-bar { background-color: var(--ltc-color); }
        .loading { text-align: center; padding: 20px; color: #8b949e; }
        .refresh-btn { margin-top: 20px; padding: 12px 25px; background: #238636; color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; width: 100%; margin-bottom: 30px;}
    </style>
</head>
<body>

    <h1>ğŸ“Š å¸‚åœºå‘¨æœŸç›‘æ§</h1>

    <div class="container">
        
        <!-- ğŸ”® å‘¨æœŸé¢„æµ‹çœ‹æ¿ -->
        <div class="card prediction-card">
            <div class="pred-header">
                <span>ğŸ”® å‘¨æœŸé¢„æµ‹</span>
                <span style="font-size: 0.8rem; color: #e6edf3;" id="today-date">ä»Šå¤©: --/--</span>
            </div>
            
            <!-- 1. ç‰›å¸‚æ—¥æœŸ -->
            <div class="pred-row">
                <span class="pred-label">ğŸ‚ ç‰›å¸‚é¡¶ç‚¹æ—¥æœŸ</span>
                <span class="pred-value bull-val">2025-10-06</span>
            </div>

            <!-- 2. ç†Šå¸‚æ—¥æœŸ -->
            <div class="pred-row">
                <span class="pred-label">ğŸ» ç†Šå¸‚ä½ç‚¹æ—¥æœŸ</span>
                <span class="pred-value bear-val">2026-10-05</span>
            </div>

            <!-- 3. ç‰›å¸‚ä»·æ ¼ -->
            <div class="pred-row">
                <span class="pred-label">ğŸ“ˆ æœ¬è½®ç‰›å¸‚æœ€é«˜ä»·</span>
                <span class="pred-value gold-val">126,199 U</span>
            </div>

            <!-- 4. ç†Šå¸‚ä»·æ ¼ -->
            <div class="pred-row">
                <span class="pred-label">ğŸ“‰ é¢„æµ‹ç†Šå¸‚ä½ç‚¹ (-70%)</span>
                <span class="pred-value bear-val">38,000 U</span>
            </div>

            <!-- 5. åŠ¨æ€å¤©æ•° -->
            <div class="pred-row dynamic-row" style="margin-top: 10px; border-top: 1px dashed #30363d;">
                <span class="pred-label" id="peak-label">è·ç¦»ç‰›å¸‚é¡¶ç‚¹è¿˜æœ‰</span>
                <span class="pred-value" style="color: #fff;" id="peak-days">--</span>
            </div>

            <div class="pred-row dynamic-row">
                <span class="pred-label">è·ç¦»ç†Šå¸‚ä½ç‚¹è¿˜æœ‰</span>
                <span class="pred-value" style="color: var(--bear-color);" id="bear-days">--</span>
            </div>

            <!-- 7. è·ç¦»æœ€ä½ç‚¹è¿˜å·® (å®æ—¶è®¡ç®—) -->
            <div class="pred-row dynamic-row" style="border-bottom: none;">
                <span class="pred-label">è·ç¦»æœ€ä½ç‚¹è¿˜å·®</span>
                <span class="pred-value price-diff" id="price-gap">ä»·æ ¼åŠ è½½ä¸­...</span>
            </div>
        </div>

        <!-- åŒºå—å‡åŠæ•°æ® -->
        <div id="app">
            <div class="loading">æ­£åœ¨è¿æ¥é“¾ä¸Šæ•°æ®...</div>
        </div>
    </div>

    <button class="refresh-btn" onclick="refreshAll()">ğŸ”„ åˆ·æ–°å…¨éƒ¨æ•°æ®</button>

    <script>
        // === 1. æ—¥æœŸé€»è¾‘ ===
        function updateDateInfo() {
            const now = new Date();
            document.getElementById('today-date').innerText = "ä»Šå¤©: " + now.toLocaleDateString('zh-CN', {year: 'numeric', month:'2-digit', day:'2-digit'});

            // ç‰›å¸‚
            const bullDate = new Date("2025-10-06T00:00:00");
            const diffBull = Math.ceil((bullDate - now) / (86400000));
            const peakLabel = document.getElementById('peak-label');
            const peakValue = document.getElementById('peak-days');

            if (diffBull > 0) {
                peakLabel.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹è¿˜æœ‰";
                peakLabel.style.color = "#8b949e";
                peakValue.innerText = `${diffBull} å¤©`;
                peakValue.style.color = "#3fb950";
            } else {
                peakLabel.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹å·²è¿‡";
                peakLabel.style.color = "#d29922"; 
                peakValue.innerText = `${Math.abs(diffBull)} å¤©`;
                peakValue.style.color = "#fff";
            }

            // ç†Šå¸‚
            const bearDate = new Date("2026-10-05T00:00:00");
            const diffBear = Math.ceil((bearDate - now) / (86400000));
            const bearValue = document.getElementById('bear-days');
            if (diffBear > 0) bearValue.innerText = `${diffBear} å¤©`;
            else bearValue.innerText = `å·²è¿‡ ${Math.abs(diffBear)} å¤©`;
        }
        
        // === 2. å®æ—¶ä»·æ ¼é€»è¾‘ ===
        async function updatePriceGap() {
            const BULL_PEAK = 126199;
            const BEAR_LOW = 38000;
            const gapElement = document.getElementById('price-gap');
            let currentPrice = 0;

            try {
                const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
                const data = await response.json();
                currentPrice = parseFloat(data.price);
            } catch (e) {
                try {
                    const resBackup = await fetch('https://mempool.space/api/v1/prices');
                    const dataBackup = await resBackup.json();
                    currentPrice = parseFloat(dataBackup.USD);
                } catch (e2) {
                    gapElement.innerText = "è·å–å¤±è´¥";
                    return;
                }
            }

            if (!currentPrice) return;

            const diffPrice = Math.floor(currentPrice - BEAR_LOW);
            let dropPercent = ((BULL_PEAK - currentPrice) / BULL_PEAK) * 100;
            let displayPrice = diffPrice > 0 ? `${diffPrice.toLocaleString()} U` : `å·²è·Œç ´!`;
            gapElement.innerText = `${displayPrice} (å·²è·Œ${dropPercent.toFixed(2)}%)`;
        }

        // === 3. åŒºå—é“¾æ•°æ® (BTC + LTC) ===
        const COINS = [
            { id: 'btc', name: 'Bitcoin', symbol: 'BTC', halvingBlock: 1050000, blockTimeSec: 600, api: 'https://mempool.space/api/blocks/tip/height', lastHalvingBlock: 840000 },
            { id: 'ltc', name: 'Litecoin', symbol: 'LTC', halvingBlock: 3360000, blockTimeSec: 150, api: 'https://api.blockcypher.com/v1/ltc/main', lastHalvingBlock: 2520000 }
        ];

        async function initBlockData() {
            const app = document.getElementById('app');
            app.innerHTML = '<div class="loading">æ­£åœ¨è¿æ¥é“¾ä¸Šæ•°æ®...</div>';
            let htmlContent = '';

            for (let coin of COINS) {
                try {
                    let currentHeight = await fetchBlockHeight(coin);
                    let blocksLeft = coin.halvingBlock - currentHeight;
                    if (blocksLeft < 0) blocksLeft = 0;

                    let totalSecondsLeft = blocksLeft * coin.blockTimeSec;
                    let estDate = new Date(new Date().getTime() + totalSecondsLeft * 1000);
                    let progress = ((currentHeight - coin.lastHalvingBlock) / (coin.halvingBlock - coin.lastHalvingBlock)) * 100;
                    progress = Math.min(100, Math.max(0, progress));

                    // ğŸŸ¢ è¿™é‡Œæ˜¯å…³é”®ä¿®æ”¹ï¼šå¢åŠ äº† year: 'numeric'
                    let dateString = estDate.toLocaleString('zh-CN', { 
                        year: 'numeric', 
                        month: '2-digit', 
                        day: '2-digit', 
                        hour: '2-digit', 
                        minute:'2-digit',
                        hour12: false 
                    });

                    htmlContent += `
                        <div class="card ${coin.id}">
                            <div class="coin-header">
                                <span class="coin-name">${coin.name}</span>
                                <span class="coin-symbol">${coin.symbol}</span>
                            </div>
                            <div class="info-row"><span class="label">å½“å‰é«˜åº¦:</span><span class="value">#${currentHeight.toLocaleString()}</span></div>
                            <div class="info-row"><span class="label">å‡åŠé«˜åº¦:</span><span class="value">#${coin.halvingBlock.toLocaleString()}</span></div>
                            <div class="progress-container"><div class="progress-bar" style="width: ${progress}%"></div></div>
                            <div style="text-align:right; font-size:12px; margin-top:5px; color:#8b949e">${progress.toFixed(2)}%</div>
                            <div class="countdown-box">
                                <div class="label">é¢„è®¡å‡åŠå€’è®¡æ—¶</div>
                                <div class="timer">${formatTime(totalSecondsLeft)}</div>
                                <div class="date-est">é¢„è®¡: ${dateString}</div>
                            </div>
                        </div>`;
                } catch (error) {
                    htmlContent += `<div class="card"><div style="padding:20px; text-align:center; color:red;">${coin.name} API ç¹å¿™ï¼Œè¯·ç¨ååˆ·æ–°</div></div>`;
                }
            }
            app.innerHTML = htmlContent;
        }

        async function fetchBlockHeight(coin) {
            const r = await fetch(coin.api);
            const d = await r.json();
            return coin.id === 'btc' ? parseInt(d) : d.height;
        }

        function formatTime(s) {
            if (s <= 0) return "å·²å‡åŠ";
            const d = Math.floor(s / 86400), h = Math.floor((s % 86400) / 3600);
            return `${d}å¤© ${h}æ—¶`;
        }
        
        function refreshAll() {
            updateDateInfo();
            updatePriceGap();
            initBlockData();
        }

        // å¯åŠ¨
        refreshAll();
    </script>
</body>
</html>
