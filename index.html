<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <!-- æ ¸å¿ƒï¼šè§†å£é€‚é…ï¼Œç¦æ­¢ç¼©æ”¾ï¼Œé€‚é…åˆ˜æµ·å± -->  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">  
      
    <title>åŠ å¯†è´§å¸å‘¨æœŸç›‘æ§</title>  
    <meta name="description" content="æ¯”ç‰¹å¸/è±ç‰¹å¸å‡åŠå€’è®¡æ—¶åŠç‰›ç†Šå‘¨æœŸé¢„æµ‹ç›‘æ§çœ‹æ¿">  
  
    <!-- === 1. å›¾æ ‡ç³»ç»Ÿ (å®Œç¾é€‚é… iOS/Android) === -->  
    <link rel="icon" href="https://maomao837491711.github.io/jianban/jianbanlogo2.png">  
    <link rel="apple-touch-icon" sizes="180x180" href="https://maomao837491711.github.io/jianban/jianbanlogo2.png">  
  
    <!-- === 2. ç¤¾äº¤åˆ†äº«ä¼˜åŒ– (Open Graph) === -->  
    <!-- å½“ä½ åˆ†äº«é“¾æ¥ç»™æœ‹å‹æˆ–å‘æ¨ç‰¹æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªå›¾ç‰‡ -->  
    <meta property="og:title" content="åŠ å¯†è´§å¸å‘¨æœŸç›‘æ§">  
    <meta property="og:description" content="BTC/LTC å‡åŠå€’è®¡æ—¶ & ç‰›ç†Šå‘¨æœŸé¢„æµ‹">  
    <meta property="og:image" content="https://maomao837491711.github.io/jianban/jianbanlogo2.png">  
    <meta property="og:type" content="website">  
  
    <!-- === 3. PWA/Web App æ¨¡å¼è®¾ç½® === -->  
    <meta name="apple-mobile-web-app-capable" content="yes">  
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">  
    <meta name="apple-mobile-web-app-title" content="å‘¨æœŸç›‘æ§">  
    <meta name="theme-color" content="#0d1117">  
  
    <style>  
        :root {  
            --bg-color: #0d1117;  
            --card-bg: #161b22;  
            --text-main: #c9d1d9;  
            --text-highlight: #58a6ff;  
            --btc-color: #f7931a;  
            --ltc-color: #345d9d;  
            --bull-color: #238636;  
            --bear-color: #da3633;  
            --gold-color: #d29922;  
            --border: #30363d;  
        }  
        * { box-sizing: border-box; }  
        body {  
            background-color: var(--bg-color);  
            color: var(--text-main);  
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;  
            margin: 0;  
            padding: 15px;  
            display: flex;  
            flex-direction: column;  
            align-items: center;  
            overflow-x: hidden;  
            padding-top: max(15px, env(safe-area-inset-top));  
            padding-bottom: max(15px, env(safe-area-inset-bottom));  
            -webkit-font-smoothing: antialiased; /* è®©å­—ä½“åœ¨ iOS ä¸Šæ›´æ¸…æ™° */  
        }  
        h1 {  
            text-align: center;  
            font-size: 1.4rem;  
            margin-bottom: 15px;  
            text-transform: uppercase;  
            letter-spacing: 1px;  
            margin-top: 10px;  
        }  
        .container {  
            width: 100%;  
            max-width: 600px;  
            display: flex;  
            flex-direction: column;  
            gap: 15px;  
        }  
          
        .card {  
            background-color: var(--card-bg);  
            border: 1px solid var(--border);  
            border-radius: 16px; /* æ›´åœ†æ¶¦çš„è§’ï¼Œç¬¦åˆ iOS é£æ ¼ */  
            padding: 20px;  
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);  
            position: relative;  
            overflow: hidden;  
            transition: transform 0.2s, box-shadow 0.2s;  
        }  
          
        .card:active { transform: scale(0.98); }  
  
        .prediction-card {  
            border: 1px solid rgba(210, 153, 34, 0.3);  
            background: linear-gradient(180deg, rgba(210, 153, 34, 0.08) 0%, rgba(22, 27, 34, 1) 100%);  
        }  
        .pred-header {  
            color: var(--gold-color);  
            font-weight: 700;  
            font-size: 1.1rem;  
            margin-bottom: 15px;  
            display: flex;  
            justify-content: space-between;  
            align-items: center;  
        }  
        .pred-row {  
            display: flex;  
            justify-content: space-between;  
            padding: 10px 0;  
            border-bottom: 1px solid rgba(255,255,255,0.06);  
            align-items: center;  
        }  
        .pred-row:last-child { border-bottom: none; }  
        .pred-label { color: #8b949e; font-size: 0.9rem; }  
        .pred-value { font-family: "SF Mono", ui-monospace, monospace; font-weight: 600; font-size: 1rem; }  
          
        .bull-val { color: #3fb950; text-shadow: 0 0 10px rgba(63, 185, 80, 0.2); }  
        .bear-val { color: #f85149; text-shadow: 0 0 10px rgba(248, 81, 73, 0.2); }  
        .gold-val { color: var(--gold-color); font-size: 1.1rem; }  
          
        .dynamic-row {  
            background: rgba(255,255,255,0.02);  
            margin: 0 -20px;  
            padding: 12px 20px;  
            border-bottom: 1px solid rgba(255,255,255,0.05);  
        }  
        .price-diff { color: #ff7b72; font-weight: bold; }   
  
        .card.btc::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background-color: var(--btc-color); }  
        .card.ltc::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background-color: var(--ltc-color); }  
  
        .coin-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 12px; }  
        .coin-name { font-size: 1.3rem; font-weight: 700; color: #ffffff; }  
        .coin-symbol { font-size: 0.9rem; opacity: 0.8; background: #30363d; padding: 4px 8px; border-radius: 6px; color: white; }  
        .info-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.95rem; }  
        .label { color: #8b949e; }  
        .value { font-family: "SF Mono", ui-monospace, monospace; color: #e6edf3; }  
        .countdown-box { background: rgba(13, 17, 23, 0.6); margin-top: 15px; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #30363d; backdrop-filter: blur(5px); }  
        .timer { font-size: 1.8rem; font-weight: 800; font-family: "SF Mono", ui-monospace, monospace; color: var(--text-highlight); margin: 5px 0; letter-spacing: -1px; }  
        .date-est { font-size: 0.85rem; color: #8b949e; margin-top: 4px;}  
        .progress-container { margin-top: 15px; background-color: #21262d; border-radius: 10px; height: 8px; overflow: hidden; }  
        .progress-bar { height: 100%; border-radius: 10px; transition: width 1s ease; }  
        .btc .progress-bar { background-color: var(--btc-color); }  
        .ltc .progress-bar { background-color: var(--ltc-color); }  
          
        .loading-text { text-align: center; padding: 20px; color: #8b949e; font-size: 0.9rem; animation: pulse 2s infinite; }  
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }  
  
        .refresh-btn {   
            margin-top: 25px; padding: 16px 25px; background: #238636; color: white;   
            border: none; border-radius: 12px; font-size: 1.05rem; font-weight: 600;  
            cursor: pointer; width: 100%; max-width: 600px; margin-bottom: 40px;  
            box-shadow: 0 4px 12px rgba(35, 134, 54, 0.4);  
            transition: all 0.2s;  
            -webkit-tap-highlight-color: transparent;  
        }  
        .refresh-btn:active { background: #1ea043; transform: scale(0.96); }  
        .refresh-btn:disabled { background: #30363d; color: #8b949e; box-shadow: none; transform: none; cursor: not-allowed; }  
          
        /* å€’è®¡æ—¶åˆ·æ–°æç¤º */  
        .auto-refresh-tip { font-size: 12px; color: #484f58; margin-top: 10px; text-align: center; }  
    </style>  
</head>  
<body>  
  
    <h1>ğŸ“Š å¸‚åœºå‘¨æœŸç›‘æ§</h1>  
  
    <div class="container">  
          
        <!-- ğŸ”® å‘¨æœŸé¢„æµ‹çœ‹æ¿ -->  
        <div class="card prediction-card">  
            <div class="pred-header">  
                <span>ğŸ”® å‘¨æœŸé¢„æµ‹</span>  
                <span style="font-size: 0.85rem; color: #e6edf3; opacity: 0.8;" id="today-date">åŠ è½½ä¸­...</span>  
            </div>  
              
            <!-- 1. ç‰›å¸‚æ—¥æœŸ -->  
            <div class="pred-row">  
                <span class="pred-label">ğŸ‚ ç‰›å¸‚é¡¶ç‚¹æ—¥æœŸ</span>  
                <span class="pred-value bull-val">2025-10-06</span>  
            </div>  
  
            <!-- 2. ç†Šå¸‚æ—¥æœŸ -->  
            <div class="pred-row">  
                <span class="pred-label">ğŸ» ç†Šå¸‚ä½ç‚¹æ—¥æœŸ</span>  
                <span class="pred-value bear-val">2026-10-05</span>  
            </div>  
  
            <!-- 3. ç‰›å¸‚ä»·æ ¼ -->  
            <div class="pred-row">  
                <span class="pred-label">ğŸ“ˆ æœ¬è½®ç‰›å¸‚æœ€é«˜ä»·</span>  
                <span class="pred-value gold-val">126,199 U</span>  
            </div>  
  
            <!-- 4. ç†Šå¸‚ä»·æ ¼ -->  
            <div class="pred-row">  
                <span class="pred-label">ğŸ“‰ é¢„æµ‹ç†Šå¸‚ä½ç‚¹ (-70%)</span>  
                <span class="pred-value bear-val">38,000 U</span>  
            </div>  
  
            <!-- 5. åŠ¨æ€å¤©æ•° -->  
            <div class="pred-row dynamic-row" style="margin-top: 10px; border-top: 1px dashed #30363d;">  
                <span class="pred-label" id="peak-label">è·ç¦»ç‰›å¸‚é¡¶ç‚¹è¿˜æœ‰</span>  
                <span class="pred-value" style="color: #fff;" id="peak-days">--</span>  
            </div>  
  
            <div class="pred-row dynamic-row">  
                <span class="pred-label">è·ç¦»ç†Šå¸‚ä½ç‚¹è¿˜æœ‰</span>  
                <span class="pred-value" style="color: var(--bear-color);" id="bear-days">--</span>  
            </div>  
  
            <!-- 7. è·ç¦»æœ€ä½ç‚¹è¿˜å·® -->  
            <div class="pred-row dynamic-row" style="border-bottom: none;">  
                <span class="pred-label">è·ç¦»æœ€ä½ç‚¹è¿˜å·®</span>  
                <span class="pred-value price-diff" id="price-gap">ğŸ”„ åŒæ­¥ä¸­...</span>  
            </div>  
        </div>  
  
        <!-- åŒºå—å‡åŠæ•°æ® -->  
        <div id="app">  
            <div class="loading-text">ğŸ“¡ æ­£åœ¨è¿æ¥é“¾ä¸ŠèŠ‚ç‚¹...</div>  
        </div>  
    </div>  
  
    <div>  
        <button class="refresh-btn" onclick="manualRefresh()">ğŸ”„ åˆ·æ–°æ•°æ®</button>  
        <div class="auto-refresh-tip">æ•°æ®æ¯ 60 ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡</div>  
    </div>  
  
    <script>  
        // === 1. æ—¥æœŸé€»è¾‘ ===  
        function updateDateInfo() {  
            const now = new Date();  
            // ä¿®å¤: ä½¿ç”¨æ›´ç¬¦åˆä¸­æ–‡ä¹ æƒ¯çš„æ—¥æœŸæ ¼å¼  
            const dateStr = now.getFullYear() + '/' + (now.getMonth()+1).toString().padStart(2, '0') + '/' + now.getDate().toString().padStart(2, '0');  
            document.getElementById('today-date').innerText = "ä»Šå¤©: " + dateStr;  
  
            // ç‰›å¸‚  
            const bullDate = new Date("2025-10-06T00:00:00");  
            const diffBull = Math.ceil((bullDate - now) / (86400000));  
            const peakLabel = document.getElementById('peak-label');  
            const peakValue = document.getElementById('peak-days');  
  
            if (diffBull > 0) {  
                peakLabel.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹è¿˜æœ‰";  
                peakLabel.style.color = "#8b949e";  
                peakValue.innerText = `${diffBull} å¤©`;  
                peakValue.style.color = "#3fb950";  
            } else {  
                peakLabel.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹å·²è¿‡";  
                peakLabel.style.color = "#d29922";   
                peakValue.innerText = `${Math.abs(diffBull)} å¤©`;  
                peakValue.style.color = "#fff";  
            }  
  
            // ç†Šå¸‚  
            const bearDate = new Date("2026-10-05T00:00:00");  
            const diffBear = Math.ceil((bearDate - now) / (86400000));  
            const bearValue = document.getElementById('bear-days');  
            if (diffBear > 0) bearValue.innerText = `${diffBear} å¤©`;  
            else bearValue.innerText = `å·²è¿‡ ${Math.abs(diffBear)} å¤©`;  
        }  
          
        // === 2. å®æ—¶ä»·æ ¼é€»è¾‘ (å¸¦é‡è¯•æœºåˆ¶) ===  
        async function updatePriceGap() {  
            const BULL_PEAK = 126199;  
            const BEAR_LOW = 38000;  
            const gapElement = document.getElementById('price-gap');  
            let currentPrice = 0;  
            const ts = new Date().getTime();  
  
            // API åˆ—è¡¨è½®è¯¢ (ç”Ÿäº§çº§å®¹é”™ï¼šå¦‚æœå¸å®‰æŒ‚äº†ï¼Œè‡ªåŠ¨åˆ‡ Mempool)  
            const apis = [  
                { url: `https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT&t=${ts}`, type: 'binance' },  
                { url: `https://mempool.space/api/v1/prices?t=${ts}`, type: 'mempool' }  
            ];  
  
            for (const api of apis) {  
                try {  
                    const response = await fetch(api.url);  
                    const data = await response.json();  
                    if (api.type === 'binance') currentPrice = parseFloat(data.price);  
                    else if (api.type === 'mempool') currentPrice = parseFloat(data.USD);  
                      
                    if (currentPrice > 0) break; // æˆåŠŸè·å–åˆ™è·³å‡ºå¾ªç¯  
                } catch (e) {  
                    console.warn(`API Failed: ${api.url}`);  
                    continue;  
                }  
            }  
  
            if (!currentPrice) {  
                gapElement.innerText = "âš ï¸ è¿æ¥å¤±è´¥";  
                return;  
            }  
  
            const diffPrice = Math.floor(currentPrice - BEAR_LOW);  
            let dropPercent = ((BULL_PEAK - currentPrice) / BULL_PEAK) * 100;  
            let displayPrice = diffPrice > 0 ? `${diffPrice.toLocaleString()} U` : `å·²è·Œç ´!`;  
            gapElement.innerText = `$${displayPrice} (å·²è·Œ$${dropPercent.toFixed(2)}%)`;  
        }  
  
        // === 3. åŒºå—é“¾æ•°æ® (BTC + LTC) ===  
        const COINS = [  
            { id: 'btc', name: 'Bitcoin', symbol: 'BTC', halvingBlock: 1050000, blockTimeSec: 600, api: 'https://mempool.space/api/blocks/tip/height', lastHalvingBlock: 840000 },  
            { id: 'ltc', name: 'Litecoin', symbol: 'LTC', halvingBlock: 3360000, blockTimeSec: 150, api: 'https://api.blockcypher.com/v1/ltc/main', lastHalvingBlock: 2520000 }  
        ];  
  
        async function initBlockData() {  
            const app = document.getElementById('app');  
              
            const tasks = COINS.map(async (coin) => {  
                try {  
                    let currentHeight = await fetchBlockHeight(coin);  
                    let blocksLeft = coin.halvingBlock - currentHeight;  
                    if (blocksLeft < 0) blocksLeft = 0;  
  
                    let totalSecondsLeft = blocksLeft * coin.blockTimeSec;  
                    let estDate = new Date(new Date().getTime() + totalSecondsLeft * 1000);  
                    let progress = ((currentHeight - coin.lastHalvingBlock) / (coin.halvingBlock - coin.lastHalvingBlock)) * 100;  
                    progress = Math.min(100, Math.max(0, progress));  
  
                    let dateString = estDate.toLocaleString('zh-CN', {   
                        year: 'numeric', month: '2-digit', day: '2-digit',   
                        hour: '2-digit', minute:'2-digit', hour12: false   
                    });  
  
                    return `  
                        <div class="card ${coin.id}">  
                            <div class="coin-header">  
                                <span class="coin-name">${coin.name}</span>  
                                <span class="coin-symbol">${coin.symbol}</span>  
                            </div>  
                            <div class="info-row"><span class="label">å½“å‰é«˜åº¦:</span><span class="value">#${currentHeight.toLocaleString()}</span></div>  
                            <div class="info-row"><span class="label">å‡åŠé«˜åº¦:</span><span class="value">#${coin.halvingBlock.toLocaleString()}</span></div>  
                            <div class="progress-container"><div class="progress-bar" style="width: ${progress}%"></div></div>  
                            <div style="text-align:right; font-size:12px; margin-top:5px; color:#8b949e">${progress.toFixed(2)}%</div>  
                            <div class="countdown-box">  
                                <div class="label">é¢„è®¡å‡åŠå€’è®¡æ—¶</div>  
                                <div class="timer">${formatTime(totalSecondsLeft)}</div>  
                                <div class="date-est">é¢„è®¡: ${dateString}</div>  
                            </div>  
                        </div>`;  
                } catch (error) {  
                    return `  
                        <div class="card">  
                            <div class="coin-header">  
                                <span class="coin-name">${coin.name}</span>  
                                <span class="coin-symbol">${coin.symbol}</span>  
                            </div>  
                            <div style="padding:20px; text-align:center; color:#f85149;">  
                                âš ï¸ API è¯·æ±‚å—é™<br>  
                                <span style="font-size:12px;color:#8b949e">å…¬å…±èŠ‚ç‚¹ç¹å¿™ï¼Œè¯·ç¨ååˆ·æ–°</span>  
                            </div>  
                        </div>`;  
                }  
            });  
  
            const results = await Promise.all(tasks);  
            app.innerHTML = results.join('');  
        }  
  
        async function fetchBlockHeight(coin) {  
            const ts = new Date().getTime();  
            const url = coin.api.includes('?') ? `$${coin.api}&t=$${ts}` : `$${coin.api}?t=$${ts}`;  
              
            // è®¾ç½®è¶…æ—¶æœºåˆ¶ï¼Œé˜²æ­¢è¯·æ±‚å¡æ­»  
            const controller = new AbortController();  
            const timeoutId = setTimeout(() => controller.abort(), 8000); // 8ç§’è¶…æ—¶  
  
            const r = await fetch(url, { signal: controller.signal });  
            clearTimeout(timeoutId);  
              
            if (!r.ok) throw new Error("API Error");  
            const d = await r.json();  
            return coin.id === 'btc' ? parseInt(d) : d.height;  
        }  
  
        function formatTime(s) {  
            if (s <= 0) return "å·²å‡åŠ";  
            const d = Math.floor(s / 86400);  
            const h = Math.floor((s % 86400) / 3600);  
            return `$${d}å¤© $${h}æ—¶`;  
        }  
          
        let isRefreshing = false;  
        async function manualRefresh() {  
            if (isRefreshing) return;  
            isRefreshing = true;  
              
            const btn = document.querySelector('.refresh-btn');  
            const originalText = btn.innerText;  
            btn.innerText = "â³ æ›´æ–°ä¸­...";  
            btn.disabled = true;  
            btn.style.opacity = "0.7";  
  
            updateDateInfo();  
              
            // æœ€å°ç­‰å¾… 500ms é˜²æ­¢é—ªçƒ  
            await new Promise(r => setTimeout(r, 500));  
            await Promise.all([updatePriceGap(), initBlockData()]);  
  
            btn.innerText = originalText;  
            btn.disabled = false;  
            btn.style.opacity = "1";  
            isRefreshing = false;  
        }  
  
        // å¯åŠ¨é€»è¾‘  
        updateDateInfo();  
        updatePriceGap();  
        initBlockData();  
  
        // è‡ªåŠ¨åˆ·æ–° (æ¯60ç§’)  
        setInterval(() => {  
            if(!document.hidden) { // åªæœ‰å½“é¡µé¢æ˜¾ç¤ºæ—¶æ‰åˆ·æ–°ï¼Œçœæµé‡  
                console.log("Auto refreshing...");  
                updatePriceGap();  
            }  
        }, 60000);  
  
    </script>  
</body>  
</html>  
