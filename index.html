<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">  
    <title>å¸‚åœºå‘¨æœŸç›‘æ§</title>  
    <link rel="icon" href="https://maomao837491711.github.io/jianban/jianbanlogo3.png">  
    <link rel="apple-touch-icon" sizes="180x180" href="https://maomao837491711.github.io/jianban/jianbanlogo3.png">  
    <meta name="apple-mobile-web-app-capable" content="yes">  
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">  
    <meta name="theme-color" content="#0d1117">  
  
    <style>  
        /* ==================== 1. åŸæœ‰æ ·å¼ (ç»å¯¹ä¿ç•™) ==================== */
        body { background-color: #0d1117; color: #c9d1d9; font-family: -apple-system, "SF Pro Text", sans-serif; margin: 0; padding: 20px 15px; display: flex; flex-direction: column; align-items: center; }  
        h1 { font-size: 1.2rem; margin-bottom: 20px; display: flex; align-items: center; gap: 8px; width: 100%; max-width: 600px; justify-content: space-between; }  
        .container { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 15px; }  
          
        .card { background: #161b22; border: 1px solid #30363d; border-radius: 12px; padding: 15px 20px; position: relative; overflow: hidden; }  
        .pred-card { border: 1px solid #d29922; background: linear-gradient(180deg, rgba(210, 153, 34, 0.05) 0%, #161b22 100%); }  
          
        .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05); align-items: center; font-size: 0.9rem; }  
        .row:last-child { border-bottom: none; }  
        .label { color: #8b949e; }  
        .val { font-family: monospace; font-weight: bold; color: #e6edf3; }  
          
        .green { color: #3fb950 !important; }  
        .red { color: #ff7b72 !important; }  
        .gold { color: #d29922 !important; }  
        .white { color: #ffffff !important; }  
        .bright-red { color: #ff3333 !important; text-shadow: 0 0 10px rgba(255, 51, 51, 0.2); }  
          
        .bg-btc { background-color: #f7931a !important; }  
        .bg-ltc { background-color: #345d9d !important; }  
        .card.btc { border-left: 4px solid #f7931a; }  
        .card.ltc { border-left: 4px solid #345d9d; }  
  
        .progress-box { margin-top: 12px; background: #21262d; border-radius: 6px; height: 8px; overflow: hidden; width: 100%; }  
        .progress-fill { height: 100%; border-radius: 6px; transition: width 0.5s; display: block; width: 0%; }  
          
        .timer-box { background: rgba(0,0,0,0.2); margin-top: 15px; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #30363d; }  
        .big-time { font-size: 1.5rem; font-weight: 800; color: #58a6ff; margin: 5px 0; letter-spacing: 0.5px; font-family: monospace; }  
          
        .btn { margin-top: 30px; padding: 12px 30px; background: #238636; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 1rem; cursor: pointer; transition: opacity 0.2s; width: 100%; }  
        .btn:active { opacity: 0.8; }  
        .btn:disabled { background: #30363d; color: #8b949e; cursor: not-allowed; opacity: 1; }  
        .tip { font-size: 12px; color: #484f58; margin-top: 10px; text-align: center; width: 100%; }  
          
        .pulse-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background-color: #3fb950; margin-left: 8px; opacity: 0; transition: opacity 0.3s; }  
        .pulse-active { opacity: 1; }  
        .update-time { font-size: 0.7rem; color: #8b949e; margin-top: 4px; text-align: right; }  

        /* ==================== 2. çŸ¿æœºç‰ˆå—æ ·å¼ ==================== */
        .hidden { display: none !important; }
        
        /* é•‚ç©ºå…¥å£æŒ‰é’® */
        .btn-outline { background: transparent; border: 1px solid #30363d; color: #58a6ff; margin-top: 15px; margin-bottom: -10px; }
        
        /* åˆ—è¡¨æ ·å¼ */
        .miner-item { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 15px; margin-bottom: 10px; }
        .miner-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .miner-name { font-weight: bold; color: #e6edf3; font-size: 1rem; }
        .miner-spec { font-size: 0.75rem; color: #8b949e; background: rgba(110,118,129,0.1); padding: 2px 6px; border-radius: 4px; }
        .shutdown-price { font-family: monospace; font-size: 1.2rem; font-weight: bold; }
    </style>  
</head>  
<body>  
  
    <h1 id="main-title">
        <span>ğŸ“Š å¸‚åœºå‘¨æœŸç›‘æ§</span>
        <!-- è¿”å›æŒ‰é’® -->
        <button id="back-btn" class="hidden" style="background:none; border:none; color:#58a6ff; font-size:0.9rem; cursor:pointer;" onclick="showHome()">
            â†© è¿”å›é¦–é¡µ
        </button>
    </h1>  
  
    <!-- ==================== é¦–é¡µ (Home) ==================== -->
    <div id="home-container" class="container">  
        <div class="card pred-card">  
            <div class="row" style="border-bottom:none; padding-bottom:15px;">  
                <span class="gold">ğŸ”® å‘¨æœŸé¢„æµ‹</span>  
                <span id="today-date" style="font-size:0.8rem; color:#8b949e">--/--</span>  
            </div>  
            <div class="row"><span class="label">ğŸ‚ ç‰›å¸‚é¡¶ç‚¹æ—¥æœŸ</span><span class="val green">2025-10-06</span></div>  
            <div class="row"><span class="label">ğŸ» ç†Šå¸‚ä½ç‚¹æ—¥æœŸ</span><span class="val red">2026-10-05</span></div>  
            <div class="row"><span class="label">ğŸ“ˆ æœ¬è½®ç‰›å¸‚æœ€é«˜ä»·</span><span class="val green">126,199 U</span></div>  
            <div class="row"><span class="label">ğŸ“‰ é¢„æµ‹ç†Šå¸‚ä½ç‚¹ (-70%)</span><span class="val red">38,000 U</span></div>  
            <div style="margin:10px 0; border-top:1px dashed #30363d"></div>  
            <div class="row"><span class="label">è·ç¦»ç‰›å¸‚é¡¶ç‚¹å·²è¿‡</span><span class="val" id="peak-days">--</span></div>  
            <div class="row"><span class="label">è·ç¦»ç†Šå¸‚ä½ç‚¹</span><span class="val white" id="bear-days">--</span></div>  
            <div class="row">  
                <span class="label">è·ç¦»æœ€ä½ç‚¹è¿˜å·®</span>  
                <div style="text-align:right">  
                    <span class="val bright-red" id="price-gap">åŠ è½½ä¸­...</span>  
                    <span id="status-dot" class="pulse-dot"></span>  
                </div>  
            </div>  
            <div class="update-time" id="last-update-time">ç­‰å¾…åŒæ­¥...</div>  
        </div>  
  
        <div class="card btc">  
            <div class="row" style="margin-bottom:10px">  
                <span style="font-size:1.3rem; font-weight:bold; color:white">Bitcoin</span>  
                <span style="background:#30363d; padding:2px 6px; border-radius:4px; font-size:0.8rem">BTC</span>  
            </div>  
            <div class="row"><span class="label">å½“å‰é«˜åº¦:</span><span class="val" id="btc-height">...</span></div>  
            <div class="row"><span class="label">å‡åŠé«˜åº¦:</span><span class="val">#1,050,000</span></div>  
            <div class="progress-box"><div id="btc-prog-bar" class="progress-fill bg-btc"></div></div>  
            <div style="text-align:right; font-size:12px; color:#8b949e; margin-top:4px" id="btc-prog-txt">0.00%</div>  
            <div class="timer-box">  
                <div class="label" style="font-size:0.9rem">é¢„è®¡å‡åŠå€’è®¡æ—¶</div>  
                <div class="big-time" id="btc-timer">--å¤© --æ—¶</div>  
                <div class="label" style="font-size:0.8rem" id="btc-date">é¢„è®¡: --/--</div>  
            </div>  
        </div>  
  
        <div class="card ltc">  
            <div class="row" style="margin-bottom:10px">  
                <span style="font-size:1.3rem; font-weight:bold; color:white">Litecoin</span>  
                <span style="background:#30363d; padding:2px 6px; border-radius:4px; font-size:0.8rem">LTC</span>  
            </div>  
            <div class="row"><span class="label">å½“å‰é«˜åº¦:</span><span class="val" id="ltc-height">...</span></div>  
            <div class="row"><span class="label">å‡åŠé«˜åº¦:</span><span class="val">#3,360,000</span></div>  
            <div class="progress-box"><div id="ltc-prog-bar" class="progress-fill bg-ltc"></div></div>  
            <div style="text-align:right; font-size:12px; color:#8b949e; margin-top:4px" id="ltc-prog-txt">0.00%</div>  
            <div class="timer-box">  
                <div class="label" style="font-size:0.9rem">é¢„è®¡å‡åŠå€’è®¡æ—¶</div>  
                <div class="big-time" id="ltc-timer">--å¤© --æ—¶</div>  
                <div class="label" style="font-size:0.8rem" id="ltc-date">é¢„è®¡: --/--</div>  
            </div>  
        </div>  

        <!-- å…¥å£æŒ‰é’® -->
        <button class="btn btn-outline" onclick="showMiner()">â›ï¸ æŸ¥è¯¢çŸ¿æœºå…³æœºå¸ä»·</button>
  
        <button id="refresh-btn" class="btn" onclick="manualRefresh()">ğŸ”„ æ‰‹åŠ¨åˆ·æ–°å…¨éƒ¨</button>  
        <div class="tip">ä»·æ ¼æ¯ 10 ç§’è‡ªåŠ¨æ›´æ–° | æ•°æ®å¯è§†åŒ–å¿ƒè·³</div>  
    </div>  

    <!-- ==================== 3. çŸ¿æœºç‰ˆå— (Hidden) ==================== -->
    <div id="miner-container" class="container hidden">
        <div class="card">
            <div class="row" style="border-bottom:none">
                <span class="gold">âš¡ æ ¸å¿ƒå‚æ•°</span>
                <span class="val white" id="miner-live-price">...</span>
            </div>
            <div class="row"><span class="label">åŸºå‡†ç”µè´¹</span><span class="val">$0.06 / kWh</span></div>
            <div class="row"><span class="label">å…¨ç½‘éš¾åº¦ (å®æ—¶)</span><span class="val" id="network-diff">Loading...</span></div>
        </div>

        <div id="miner-list">
            <!-- JS è‡ªåŠ¨å¡«å…… -->
        </div>
        
        <!-- åº•éƒ¨æ–‡æ¡ˆ -->
        <div class="tip">
            <span style="color:#d29922">ç¬¬ä¸€æ”¯æ’‘</span>ï¼šåŸºç¡€ä¸»æµæœºå‹ï¼ŒæŠ„åº•ç¬¬ä¸€æ”¯æ’‘ä½ã€‚<br>
            <span style="color:#e6edf3">é»„é‡‘å‘</span>ï¼šä¸»åŠ›æœºå‹ï¼ŒæŠ„åº•é»„é‡‘å‘ä½ã€‚<br>
            <span style="color:#3fb950">é’»çŸ³å‘</span>ï¼šæ——èˆ°é«˜æ•ˆæœºå‹ï¼ŒæŠ„åº•é’»çŸ³å‘ä½ã€‚
        </div>
    </div>
  
    <script>  
        // é…ç½®
        const BULL_PEAK = 126199;  
        const BEAR_LOW = 38000;  
        const ELEC_COST = 0.06;
        
        // === çŸ¿æœºæ•°æ®åº“ (å·²ä¿®æ­£æ•°æ®) ===
        const MINERS = [
            // --- ç¬¬ä¸€æ”¯æ’‘ (High Cost) ---
            // ä¿®æ­£ï¼š172T/3423W, å»é™¤ï¼ˆæµ¸æ²¡ï¼‰
            { name: "ç¥é©¬ M60", hash: 172, watts: 3423, tag: "ç¬¬ä¸€æ”¯æ’‘", color: "#d29922" },
            // ä¿®æ­£ï¼š238T/4736W
            { name: "ç¥é©¬ M66", hash: 238, watts: 4736, tag: "ç¬¬ä¸€æ”¯æ’‘", color: "#d29922" },

            // --- é»„é‡‘å‘ (Mid Efficiency) ---
            // åˆ é™¤ M60S, M63S
            { name: "æµ·è±¹ A2 (æ ‡å‡†)", hash: 226, watts: 3729, tag: "é»„é‡‘å‘", color: "#e6edf3" }, 
            { name: "Antminer S21 Hyd.", hash: 335, watts: 5360, tag: "é»„é‡‘å‘", color: "#e6edf3" }, 

            // --- é’»çŸ³å‘ (Top Efficiency) ---
            // ä¿®æ­£ï¼š660T/8250W
            { name: "æµ·è±¹ A3 Pro (æ°´å†·)", hash: 660, watts: 8250, tag: "é’»çŸ³å‘", color: "#3fb950" }, 
            { name: "Antminer S23 Hyd.", hash: 580, watts: 5510, tag: "é’»çŸ³å‘", color: "#3fb950" }, 
            { name: "Antminer U3S23H", hash: 1160, watts: 11020, tag: "é’»çŸ³å‘", color: "#3fb950" }
        ];

        // å…¨å±€çŠ¶æ€
        let currentPrice = 0;
        let currentDiff = 0;

        // === è§†å›¾åˆ‡æ¢ ===
        function showMiner() {
            document.getElementById('home-container').classList.add('hidden');
            document.getElementById('miner-container').classList.remove('hidden');
            document.getElementById('back-btn').classList.remove('hidden');
            document.getElementById('main-title').querySelector('span').innerText = "â›ï¸ çŸ¿æœºé£æ§é›·è¾¾";
            
            if(currentDiff === 0) fetchDifficulty();
            else renderMiners();
        }

        function showHome() {
            document.getElementById('miner-container').classList.add('hidden');
            document.getElementById('home-container').classList.remove('hidden');
            document.getElementById('back-btn').classList.add('hidden');
            document.getElementById('main-title').querySelector('span').innerText = "ğŸ“Š å¸‚åœºå‘¨æœŸç›‘æ§";
        }

        // === æ—¥æœŸé€»è¾‘ ===
        function updateDate() {  
            var now = new Date();  
            document.getElementById('today-date').innerText = now.toLocaleDateString('zh-CN');  
            var bullDate = new Date("2025-10-06").getTime();  
            var bearDate = new Date("2026-10-05").getTime();  
            var today = now.getTime();  
            var diffBull = Math.floor((bullDate - today) / 86400000);  
            var peakEl = document.getElementById('peak-days');  
            if (diffBull > 0) {  
                peakEl.innerHTML = diffBull + " å¤©";  
                peakEl.className = "val green";  
                peakEl.previousElementSibling.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹è¿˜æœ‰";  
            } else {  
                peakEl.innerHTML = Math.abs(diffBull) + " å¤©";  
                peakEl.className = "val";  
                peakEl.previousElementSibling.innerText = "è·ç¦»ç‰›å¸‚é¡¶ç‚¹å·²è¿‡";  
            }  
            var diffBear = Math.ceil((bearDate - today) / 86400000);  
            document.getElementById('bear-days').innerText = diffBear + " å¤©";  
        }  
  
        // === ä»·æ ¼è·å– ===
        async function updatePrice() {  
            var gapEl = document.getElementById('price-gap');  
            var timeEl = document.getElementById('last-update-time');  
            var dotEl = document.getElementById('status-dot');  
            var price = 0;  
            var timestamp = new Date().getTime();  
  
            var apis = [  
                { url: 'https://api.coincap.io/v2/assets/bitcoin?t=' + timestamp, type: 'coincap' },
                { url: 'https://mempool.space/api/v1/prices?t=' + timestamp, type: 'mempool' }
            ];  
  
            for (var i = 0; i < apis.length; i++) {  
                try {  
                    var controller = new AbortController();  
                    var id = setTimeout(function() { controller.abort(); }, 3000);  
                    var res = await fetch(apis[i].url, { signal: controller.signal });  
                    clearTimeout(id);  
  
                    if (res.ok) {  
                        var data = await res.json();  
                        if (apis[i].type === 'coincap') price = parseFloat(data.data.priceUsd);  
                        else if (apis[i].type === 'mempool') price = parseFloat(data.USD);  
                        if (price > 0) break; 
                    }  
                } catch (e) {}  
            }  
  
            if (price > 0) {  
                currentPrice = price;
                
                var diff = Math.floor(price - BEAR_LOW);  
                var drop = ((BULL_PEAK - price) / BULL_PEAK * 100).toFixed(2);  
                gapEl.className = "val bright-red";   
                if (diff > 0) gapEl.innerText = diff.toLocaleString() + " U (å·²è·Œ" + drop + "%)";  
                else gapEl.innerText = "å·²è·Œç ´åº•ä»·!";  
  
                var now = new Date();  
                timeEl.innerText = "æ›´æ–°äº " + now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0') + ":" + now.getSeconds().toString().padStart(2,'0');  
                dotEl.classList.add('pulse-active');  
                setTimeout(function() { dotEl.classList.remove('pulse-active'); }, 500);

                document.getElementById('miner-live-price').innerText = "$" + Math.floor(price).toLocaleString();
                renderMiners();
            } 
        }  

        // === éš¾åº¦è·å– ===
        async function fetchDifficulty() {
            try {
                let r1 = await fetch('https://mempool.space/api/blocks/tip/hash');
                let hash = await r1.text();
                let r2 = await fetch('https://mempool.space/api/block/' + hash);
                let d = await r2.json();
                currentDiff = d.difficulty; 
                document.getElementById('network-diff').innerText = (currentDiff/1e12).toFixed(2) + " T";
                renderMiners();
            } catch(e){
                console.log("éš¾åº¦è·å–ä¸­...");
            }
        }

        // === çŸ¿æœºè®¡ç®— ===
        function renderMiners() {
            if(currentPrice === 0 || currentDiff === 0) return;
            
            const list = document.getElementById('miner-list');
            list.innerHTML = "";
            
            const btcPerTH = (3.125 * 86400 * 1000000000000) / (currentDiff * 4294967296);

            let data = MINERS.map(m => {
                let rev = m.hash * btcPerTH;
                let cost = (m.watts/1000) * 24 * ELEC_COST;
                let shut = cost / rev;
                return {...m, shut};
            });
            
            data.sort((a,b) => b.shut - a.shut);

            data.forEach(m => {
                let gap = currentPrice - m.shut;
                let isBroken = gap <= 0;
                let barColor = isBroken ? "#ff7b72" : (gap/currentPrice < 0.15 ? "#d29922" : "#3fb950");
                let statusText = isBroken ? "å·²è·Œç ´" : `å®‰å…¨å« ${((gap/currentPrice)*100).toFixed(1)}%`;

                let html = `
                <div class="miner-item" style="border-left: 3px solid ${m.color}">
                    <div class="miner-top">
                        <div>
                            <span class="miner-name">${m.name}</span>
                            <span class="miner-spec">${m.tag}</span>
                        </div>
                        <span style="font-size:0.8rem; color:${barColor}; font-weight:bold">${statusText}</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; align-items:flex-end">
                        <div>
                            <span style="font-size:0.7rem; color:#8b949e; display:block">å…³æœºå¸ä»·</span>
                            <span class="shutdown-price" style="color:${isBroken ? '#ff7b72' : '#e6edf3'}">$${Math.floor(m.shut).toLocaleString()}</span>
                        </div>
                        <div style="font-size:0.75rem; color:#8b949e">${m.hash}T / ${m.watts}W</div>
                    </div>
                </div>`;
                list.insertAdjacentHTML('beforeend', html);
            });
        }
  
        // === åŸæœ‰åŒºå—é€»è¾‘ ===
        async function fetchBlockHeight(url) {  
            try {  
                var controller = new AbortController();  
                var id = setTimeout(function() { controller.abort(); }, 4000);  
                var res = await fetch(url, { signal: controller.signal });  
                clearTimeout(id);  
                return await res.json();  
            } catch(e) { return null; }  
        }  
  
        async function updateBlocks() {  
            var btcHeight = await fetchBlockHeight('https://mempool.space/api/blocks/tip/height');  
            if(btcHeight) renderBlockData(btcHeight, 1050000, 840000, 600, 'btc');  
            var ltcData = await fetchBlockHeight('https://api.blockcypher.com/v1/ltc/main');  
            if(ltcData && ltcData.height) renderBlockData(ltcData.height, 3360000, 2520000, 150, 'ltc');  
            fetchDifficulty(); 
        }  
  
        function renderBlockData(height, halving, last, time, id) {  
            document.getElementById(id + '-height').innerText = '#' + height.toLocaleString();  
            var left = Math.max(0, halving - height);  
            var totalSeconds = left * time;  
            var percent = ((height - last) / (halving - last) * 100);  
            if(percent > 100) percent = 100; if(percent < 0) percent = 0;  
              
            document.getElementById(id + '-prog-bar').style.width = percent + "%";  
            document.getElementById(id + '-prog-txt').innerText = percent.toFixed(2) + "%";  
            var days = Math.floor(totalSeconds / 86400);  
            var hours = Math.floor((totalSeconds % 86400) / 3600);  
            document.getElementById(id + '-timer').innerText = days + "å¤© " + hours + "æ—¶";  
            var d = new Date(new Date().getTime() + totalSeconds * 1000);  
            var ds = d.getFullYear() + "/" + (d.getMonth()+1).toString().padStart(2,'0') + "/" + d.getDate().toString().padStart(2,'0') + " " + d.getHours().toString().padStart(2,'0') + ":" + d.getMinutes().toString().padStart(2,'0');  
            document.getElementById(id + '-date').innerText = "é¢„è®¡: " + ds;  
        }  
  
        async function manualRefresh() {  
            var btn = document.getElementById('refresh-btn');  
            btn.innerText = "â³"; btn.disabled = true; btn.style.opacity = "0.8";  
              
            updateDate();  
            await Promise.all([updatePrice(), updateBlocks()]);  
  
            setTimeout(function() {  
                btn.innerText = "âœ…";  
                setTimeout(function() { btn.innerText = "ğŸ”„ æ‰‹åŠ¨åˆ·æ–°å…¨éƒ¨"; btn.disabled = false; btn.style.opacity = "1"; }, 1000);  
            }, 1000);  
        }  
  
        manualRefresh();  
  
        setInterval(function() { if (!document.hidden) updatePrice(); }, 10000);  
        setInterval(function() { if (!document.hidden) { updateBlocks(); updateDate(); } }, 600000);  
    </script>  
</body>  
</html>
